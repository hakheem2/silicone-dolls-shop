{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    {% block meta %}

    {% endblock %}

    <link rel="icon" href="{% static 'images/favicon.png' %}" type="image/x-icon" />
    <!-- Google icons links -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- FontAwesome icons -->
    <script src="https://kit.fontawesome.com/882aba611a.js" crossorigin="anonymous"></script>
    <!-- Google fonts CDN link -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair:ital,opsz,wght@0,5..1200,300..900;1,5..1200,300..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <!-- Bootstrap CDN link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <!-- jQuery link -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <!-- Custom CSS links -->
    <link rel="stylesheet" href="{% static 'css/fonts.css' %}">
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    {% block links %}

    {% endblock %}

</head>
<body class="body" style="">
    <form method="POST">
        {% csrf_token %}
    </form>

    {% block content %}

    {% endblock %}

        <!-- ===================== FOOTER SECTION ===================== -->
        <footer class="footer">
            <div class="container">
                <hr>
                <div class="row">
                    <!-- Footer Left: Logo & Contact -->
                    <div class="col col-12 col-md-4">
                        <div class="site-img">
                            <img src="{% static 'images/site-logo.avif' %}" alt="carolineheusssiliconedolls">
                        </div>
                        <div class="contact-info">
                            <a href="tel:+13233754195" target="_blank" class="icon phone-icon poppins-regular fs-6"><span class="material-symbols-outlined">call</span>+1(323)375-4195</a> <br>
                            <a href="mailto:support@carolineheusssiliconedolls.com" target="_blank" class="icon email-icon raleway-medium"><span class="material-symbols-outlined">mail</span>support@carolineheuss.com</a> <br>
                            <a href="https://maps.app.goo.gl/kzZSdem6THUGRBnF7" target="_blank" class="icon address-icon raleway-medium">7147 Churchland St Pittsburgh,  <br> PA 15206, USA</a>
                        </div>
                    </div>
                    <!-- Footer Center: Site Links -->
                    <div class="footer-links col col-12 col-md-4">
                        <div class="wrapper">
                            <h5 class="title">Site Maps</h5>
                            <ul class="list">
                                <li class="list-item"><a class="list-link" href="{% url 'home' %}">Home</a></li>
                                <li class="list-item"><a class="list-link" href="{% url 'product_list' %}">Our Babies</a></li>
                                <li class="list-item"><a class="list-link" href="{% url 'about' %}">About Us</a></li>
                                <li class="list-item"><a class="list-link" href="{% url 'blog' %}">Blog</a></li>             
                                <li class="list-item"><a class="list-link" href="{% url 'contact' %}">Contact Us</a></li>
                                <li class="list-item"><a class="list-link" href="{% url 'faq' %}">FAQ</a></li>
                                <li class="list-item"><a class="list-link" href="{% url 'terms' %}">Terms of Service</a></li>
                            </ul>
                        </div>
                    </div>
                    <!-- Footer Right: Newsletter & Social -->
                    <div class="join-us col col-12 col-md-4">
                        <h5 class="title">Join Our Community</h5>
                        <form action="" class="form">
                            <div class="form-floating d-flex justify-content-between align-items-center">
                                <input type="text" class="form-control" name="email" id="email" placeholder="Email...">
                                <label for="#email">Email...</label>
                                <button class="btn btn-lg">Subscribe</button>
                            </div>
                        </form>
                        <div class="follow-us">
                            <h5 class="title">Follow Us On</h5>
                            <div class="icon-list">
                                <a href="https://www.facebook.com/" target="_blank" class="icon"><i class="fa-brands fa-facebook"></i></a>
                                <a href="https://www.instagram.com/" target="_blank" class="icon"><i class="fa-brands fa-square-instagram"></i></a>
                                <a href="mailto:support@carolineheusssiliconedolls.com" target="_blank" class="icon"><i class="fa-solid fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                    <!-- Footer Bottom: Copyright -->
                    <div class="col col-12 text-start text-md-center px-0 m-0">
                        <p class="small text-muted">
                            Â© 2025 Caroline Heuss Silicone Dolls. All rights reserved. No part of this site, images, or content may be reproduced, stored, or transmitted in any form without prior written permission from Caroline Heuss Silicone Dolls.
                        </p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- ===================== FOOTER SECTION END ===================== -->
    </main>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
    <!-- Custom JS -->
    <!-- base.html or your main HTML -->
<script>
    // Function to get CSRF token from cookie
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                cookie = cookie.trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    const csrftoken = getCookie('csrftoken');

    // Automatically add CSRF token to all AJAX requests
    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            const safeMethod = /^(GET|HEAD|OPTIONS|TRACE)$/.test(settings.type);
            if (!safeMethod && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });
</script>


     <script>
        // scroll fadein anamtion on all contents
        function isInViewport(element) {
			const rect = element.getBoundingClientRect();
			return (
			rect.top <= (window.innerHeight || document.documentElement.clientHeight) &&
			rect.bottom >= 0
			);
		}

		function animateOnScroll() {
			$('body *:not(script):not(style):not(link):not(meta)').each(function () {
				if (isInViewport(this)) {
					$(this).addClass('visible')
				}
			});
		}


        $(document).ready(function () {
            var $sidebarCon = $('#sidebar_con');
            var $openBtn = $('#sidebar_open');
            var $closeBtn = $('#sidebar_close_btn');

            // Open sidebar
            $openBtn.on('click', function () {
            $sidebarCon.addClass('show');
            });

            // Close sidebar
            $closeBtn.on('click', function () {
            $sidebarCon.removeClass('show');
            });

            // Close if clicking outside sidebar (on overlay)
            $sidebarCon.on('click', function (e) {
            if (e.target === this) {
                $sidebarCon.removeClass('show');
            }
            });



			// Animate on load
			animateOnScroll();
			// Animate on scroll
			$(window).on('scroll resize', function () {
			animateOnScroll();
			});
        


            // Handle add-to-cart click
            $('.add-to-cart').on('click', function (e) {
                e.preventDefault();

                const productId = $(this).data('product-id');
                const quantity = 1;  // Default quantity for home page buttons

                $.ajax({
                    type: 'POST',
                    url: '{% url "cart:add_to_cart" %}',
                    data: {
                        'product_id': productId,
                        'quantity': quantity,
                    },
                    success: function (response) {
                        // Optional: update cart count
                        $('#cart-count').text(response.cart_count);
                        $('#alertBox').css('display', 'block').html(
                            `<div class="card-body pt-2 text-center d-flex align-items-center justify-content-center" style="opacity: 1 !important; transform: translateY(0) !important;">
                                <h3 class="raleway-semibold text-success fs-5 pe-2" style="opacity: 1 !important; transform: translateY(0) !important;">Product added to cart</h3>
                                <span class="material-symbols-outlined text-success h2 py-0" style="opacity: 1 !important; transform: translateY(0) !important;">check_circle_unread</span>
                            </div> 
                            <i class="text-warning d-block mx-auto raleway-medium" style="font-size: 1re,rem; opacity: 1 !important; transform: translateY(0) !important;">closing in 2s</i>`
                        );
						setTimeout(function() {
						$('#alertBox').fadeOut();
						}, 2000);
                    },
                    error: function (xhr, errmsg, err) {
						setTimeout(function() {
						$('#alertBox').css('display', 'block').html(
                            `<div class="card-body pt-2 text-center d-flex align-items-center justify-content-center" style="opacity: 1 !important; transform: translateY(0) !important;">
                                <h3 class="raleway-semibold text-warning fs-5 pe-2" style="opacity: 1 !important; transform: translateY(0) !important;">Error adding product to cart</h3>
                                <span class="material-symbols-outlined text-warning h2 py-0" style="opacity: 1 !important; transform: translateY(0) !important;">check_circle_unread</span>
                            </div>
                            <p class="text-warning d-block mx-auto raleway-medium" style="font-size: 1re,rem; opacity: 1 !important; transform: translateY(0) !important;">closing in 2s</p>`
                        ).fadeOut();
						}, 2000);
                    }
                });
            });


            //styling wishlist buttons on load
        

            //add products to wishlist
            $('.favourite').on('click', function(e) {
                e.preventDefault();

                let button = $(this);
                let productId = button.data('product-id');
                let isInWishlist = button.data('wishlist-added');  // 1 or 0

                let url = isInWishlist == 1 
                    ? '{% url "add_to_wishlist" %}'
                    : '{% url "remove_from_wishlist" %}';
                $.ajax({
                    url: url,
                    type: 'POST',
                    
                    data: {
                        'product_id': productId,
                    },
                    success: function(response) {
                        if (response.success) {
                            // Toggle the state
                            let newState = isInWishlist == 1 ? 0 : 1;
                            button.data('wishlist-added', newState);

                            // Toggle icon fill
                            let icon = button.find('.material-symbols-outlined');
                            icon.css('font-variation-settings', `"FILL" ${newState}`);
                        }
                    },
                    error: function() {
                            setTimeout(function() {
                            $('#alertBox').css('display', 'block').html(
                                `<div class="card-body pt-2 text-center d-flex align-items-center justify-content-center" style="opacity: 1 !important; transform: translateY(0) !important;">
                                    <h3 class="raleway-semibold text-warning fs-5 pe-2" style="opacity: 1 !important; transform: translateY(0) !important;">An error occurred, please try again</h3>
                                    <span class="material-symbols-outlined text-warning h2 py-0" style="opacity: 1 !important; transform: translateY(0) !important;">check_circle_unread</span>
                                </div>
                                <p class="text-warning d-block mx-auto raleway-medium" style="font-size: 1re,rem; opacity: 1 !important; transform: translateY(0) !important;">closing in 2s</p>`
                            ).fadeOut();
                            }, 2000);
                    }
                });
            });
        });
        
    </script>
</body>
</html>

